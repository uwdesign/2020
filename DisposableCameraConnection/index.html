<!-- Thipok Cholsaipant 10.59-->
<html xmlns="http://www.w3.org/1999/xhtml">
<meta charset="UTF-8">

<head>
    <style>
        html {
            overflow-x: scroll;
            overflow-y: hidden;
        }

        body {
            font-family: sans-serif;
            margin: 0;
            padding: 0;
        }

        .item {
            float: left;
            position: relative;
            line-height: 1em;
            /* opacity: 0; */
        }

        .grid-sizer {
            width: 45vh;
        }

        .item {
            width: calc(45vh - 24px);
            margin: 12px;
        }

        .image {
            max-width: 100%;
            margin: 0;
            display: block;
        }

        .image:after {
            clear: both;
        }

        .overlay {
            /* width: 100%; */
            /* height: 100%; */
            position: absolute;
            bottom: 0;
            left: 0;
            text-decoration: none;
            color: #fff;
            display: none;

            transform-origin: bottom left;
            transform: rotate3d(0, 0, 1, 90deg) translate3d(-100%, 0, 0);
            /* Note: for a CLOCKWISE rotation, use the commented-out
            transform instead of this one. */
            /* transform: rotate(90deg) translate(0, -100%) */
        }

        .item:hover .overlay {
            display: block;
        }

        #loadMore {
            position: fixed;
            top: 0px;
            left: 0px;
        }

        #bodycontent {
            width: 95vh;
            padding-top: 24px;
            padding-left: 24px;
            padding-bottom: 25vw;
            transform-origin: top left;
            transform: rotate(-90deg) translate(-100vh, 0%);
        }

        #rotatecontainer {
            height: 100vh;
            overflow-y: hidden;
            margin: 0;
        }
    </style>
</head>

<body>
    <div id="rotatecontainer">
        <div id="bodycontent">
            <div id="container">
                <div class="grid-sizer">
                </div>
            </div>
        </div>
    </div>



    <button id="loadMore" type="button">Load more</button>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/masonry/4.0.0/masonry.pkgd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.0/imagesloaded.pkgd.min.js"></script>

    <script>
        const $uwdimg = "https://images.uwdesignshow.com/?"
        const imgquery = "ro=90&af&il&auth=uw"
        const urlpath = "https://gh.uwdesignshow.com/2020/DisposableCameraConnection/"
        const itemsCount = 2

        //
        // When jquery is ready
        $(document).ready(function () {
            function getUrlVars() {
                var vars = [],
                    hash;
                var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
                for (var i = 0; i < hashes.length; i++) {
                    hash = hashes[i].split('=');
                    vars.push(hash[0]);
                    vars[hash[0]] = hash[1];
                }
                return vars;
            }

            const urlParams = getUrlVars();

            var json = {}

            var hiddenItems = {}
            var addedItems = {}

            $.getJSON( urlpath + "data/" + urlParams["data"],
                function (data) {
                    json = data
                    items = data.images
                });

            $('#container').masonry({
                itemSelector: ".item",
                columnWidth: ".grid-sizer",
                hiddenStyle: {
                    transform: 'translateY(50px)',
                    opacity: 0
                },
                visibleStyle: {
                    transform: 'translateY(0px)',
                    opacity: 1
                }
                // "gutter": "12"
                // "transitionDuration": "0"
            });

            function srcSet(url, sizes) {
                var srcSetString = "";
                sizes.forEach(function (elem) {
                    srcSetString += ($uwdimg + imgquery + "&w=" + elem + "&url=" + url);
                    srcSetString += (" " + elem + "w, ");
                })
                return srcSetString;
            }

            function generateItem(itemData) {
                var src = urlpath + "images/" + itemData.src.substring('1')
                return '<div class="item new"><img srcset="' +
                    srcSet(src, [100, 300, 500, 750, 1000, 1500, 2500, 5000]) +
                    '" class="image"><a class="overlay" href="https://www.uwdesignshow.com/students/' + itemData
                    .slug + '">' + itemData.name + '</a></div>';
            }

            function addItemFrom() {
                var elems = []
                for (var i = itemsCount; i >= 0; i--) {
                    if (hiddenItems.length > 0) {
                        var item = hiddenItems.splice(Math.floor(Math.random() * hiddenItems.length), 1);
                        $item = $(generateItem(item))
                        elems.push($item);
                        addedItems.push([item, $item]);
                    } else {
                        break;
                    }
                }
        
                //                 console.log($elems)
                $('#container').append(elems)
                console.log($('#container').find('.item'))

                $('#container').masonryImagesReveal($('#container').find('.item'))
                $('#loadMore').show()
            }

            $.fn.masonryImagesReveal = function ($items) {
                var msnry = this.data('masonry');
                var itemSelector = msnry.options.itemSelector;
                console.log($items.filter('.new'));
                // hide by default
                $items.filter('.new').hide();

                // append to container
                this.append($items);
                $items.filter('.new').imagesLoaded().progress(function (imgLoad, image) {
                    // get item
                    // image is imagesLoaded class, not <img>, <img> is image.img
                    var $item = $(image.img).parents(itemSelector);

                    // masonry does its thing
                    setTimeout(function () {
                        // un-hide item
                        $item.show();

                        //your code to be executed after 1 second
                        msnry.appended($item);
                        $('#container').masonry();
                    }, 500);
                    // $('#container').masonry('reloadItems')

                    $item.removeClass('new');
                });
                return this;
            };

            $('#loadMore').click(function () {
                $(this).hide();
                addItemFrom($dataset);
            });

        });
    </script>
</body>

</html>